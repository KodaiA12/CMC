一度目の実験(2024/11まで)
コード作成や実験などを「機械学習による X 線 CT 画像からの亀裂の自動抽出」という論文を参考に行った。
100epochでの実験を行ったが、グラフを見る限り、20epochほどで学習が収束していて、eval_lossが上がってしまっていることから過学習が疑われる。
また、ラベルに用いたgt画像が古いものであったため、精度があまりよく出なかったと思われる。(secondで修正済み)
secondで行うこと(予定)：gtを新しいものにして学習を行う・学習が収束したら終了するようにコードを変更する・正解画像と推論画像を1枚の画像にして見比べるようにする・グラフを0～1の値域で常に作成するように変更する
以下、result毎の評価方法
results_2024-11-19：デバックで試しただけ。何もない。
results_2024-11-16：うまくコードが実験できるか3epochで試してみた。u-net++が32の倍数でしか動かないことがこの実験から発覚したため、ラベルと画像は50*50でクロップされている。参考にはならない
results_2024-11-28:データセットを32*32にして、100epochで実験をした結果。ここまではData_Augmentation.pyのn=5でやっていたが、グラフからlossとaccuracyどちらもevalが不安定な動きや、trainingから乖離していたため、データ枚数が足りないのではないかと考えた。
results_2024-11-29:データ数をn=10で行った。言うて変わらないことが分かった。(グラフを見ると変わったように一見見えるが、値域がめちゃめちゃだったため。csvを見るとそこまで変わっていない。)

参考までにmodelの詳細
model = smp.UnetPlusPlus(
    encoder_name="resnet34",
    encoder_weights="imagenet",
    in_channels=1,
    classes=1,
    activation='sigmoid'
)
論文ではsoftmax2dが活性化関数として利用されていたが、softmax2dは多クラス分類に適しているのに対し、二値分類問題ではsigmoidの方が適しているので、亀裂の判別ではsigmoidを用いている。